# Mixed-Bg-Fg-Synthesis via Conditional GLO
Official Implementation of [Stingray Detection of Aerial Images Using Augmented Training Images Generated by A Conditional Generative Model](https://arxiv.org/abs/1805.04262)

Created by [Yi-Min Chou](https://github.com/yyyjoe), Chien-Hung Chen, Keng-Hao Liu, Chu-Song Chen

## The overview of data augmentation

![alt tag](./assets/overview.png)

1. Crop the object patches (rotate and flip to augment data) and randomly crop the background patches to establish the dataset for training conditional GLO.
2. Training conditional GLO and use the well-trained model to generate the fake stingray image.
3. Paste the generated stingray patches to original positions.
4. Use the augmented data generated from C-GLO to train detection models. 
 
## Conditional-Generative-Latent-Optimization

![alt tag](./assets/cglo-1.png)

## Prerequisition
- Python 2.7
- [TensorFlow 1.4.0 or higher](https://github.com/tensorflow/tensorflow)

## How to Run

- Clone the Mixed-Bg-Fg-Synthesis repository:
```bash
$ git clone --recursive https://github.com/ivclab/ConditionalGLO.git
```

- Install required packages:
```bash
$ pip install -r requirements.txt
```

- Download Stingray Data:
```bash
$ python download.py
```

- Run the training code:
```bash
# The training result will be saved in `./logs/FOLDER_NAME/`
$ python main.py --is_train=True
```

- Run the testing code:
```bash
# The testing result will be saved in `./logs/FOLDER_NAME_test/`
$ python main.py --is_train=False --load_path=FOLDER_NAME
```

## Experimental Results
Original background image(top), mixed background and foreground synthesis generated by C-GLO (bottom)
![alt tag](./assets/Fig5-1.png)


## Citation
Please cite following paper if these codes help your research:

    @inproceedings{chou2018stingray,
      title={Stingray Detection of Aerial Images Using Augmented Training Images Generated by a Conditional Generative Model},
      author={Chou, Yi-Min and Chen, Chien-Hung and Liu, Keng-Hao and Chen, Chu-Song},
      booktitle={Proceedings of the IEEE Conference on Computer Vision and Pattern Recognition Workshops},
      pages={1403--1409},
      year={2018}
    }
    
    @inproceedings{
      title   = {Changing Background to Foreground: An Augmentation Method Based on Conditional Generative Network for Stingray Detection},
      Author  = {Chou, Yi-Min and Chen, Chien-Hung and Liu, Keng-Hao and Chen, Chu-Song}, 
      booktitle = {IEEE International Conference on Image Processing, ICIP},
      year    = {2018}
    }

## Contact
Please feel free to leave suggestions or comments to [Yi-Min Chou](https://github.com/yyyjoe), Chien-Hung Chen(redsword26@iis.sinica.edu.tw), Keng-Hao Liu(keng3@mail.nsysu.edu.tw), Chu-Song Chen(song@iis.sinica.edu.tw)
